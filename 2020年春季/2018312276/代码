Creditrisk<-read.csv("C:/Users/mihuan/Desktop/r/third/credit_risk.csv",header = TRUE)

cuhigh<-subset(Creditrisk,Creditrisk$Credit.Risk=="High",select=Age)
culow<-subset(Creditrisk,Creditrisk$Credit.Risk=="Low",select=Age)
library(psych)
cuh<-describe(cuhigh)
cul<-describe(culow)
all<-describe(Creditrisk$Age)
write.csv(rbind(cuh,cul,all),"C:/Users/mihuan/Desktop/r/third/Risk&age--des.csv")
boxplot(Creditrisk$Age~Creditrisk$Credit.Risk,range=1.5,
        varwidth=T,col="lightpink",horizontal = F,
        ylab="",xlab="Credit Risk",
        main="两种风险水平的Age数据")
library(BSDA)
cuhigh<-as.matrix(cuhigh)
culow<-as.matrix(culow)

s1<-z.test(cuhigh,sigma.x = sd(cuhigh),unlist(culow),sigma.y = sd(culow))
par(mfrow=c(1,2),cex=0.8)
#绘制qq图
#绘制qq图
qqnorm(as.matrix(cuhigh),xlab = "期望正态值",ylab="观察值",main="high的Q-Q图",datax=TRUE)
qqline(as.matrix(cuhigh),datax=TRUE,col="red")
qqnorm(as.matrix(culow),xlab = "期望正态值",ylab="观察值",main="low的Q-Q图",datax=TRUE)
qqline(as.matrix(culow),datax=TRUE,col="red")

#ks.test(cuhigh,"pnorm",mean(cuhigh),sd(cuhigh))
#用jitter给重复数据加噪音：

shapiro.test(cuhigh)
shapiro.test(culow)
ks.test(jitter(cuhigh),'pnorm',mean(cuhigh),sd(cuhigh))
ks.test(jitter(culow),'pnorm',mean(culow),sd(culow))
bartlett.test(Creditrisk$Age~Creditrisk$Credit.Risk)
kruskal.test(Creditrisk$Age~Creditrisk$Credit.Risk)
